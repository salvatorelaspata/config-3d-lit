{"version":3,"file":"viewer-3d-lit.js","sourceRoot":"","sources":["src/viewer-3d-lit.ts"],"names":[],"mappings":"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","sourcesContent":["// import { createComponent } from '@lit-labs/react'\r\nimport * as THREE from 'three'\r\nimport { LitElement, html, css } from 'lit'\r\nimport { customElement, property, query } from 'lit/decorators.js'\r\nimport { classMap } from 'lit/directives/class-map.js'\r\n// import React from 'react'\r\nimport { applyTextureOnMesh, use3DViewer } from './hook/use3DViewer'\r\nimport { Viewer3dType } from './types/types'\r\n\r\n@customElement('viewer-3d-lit')\r\nexport class Viewer3d extends LitElement {\r\n  // modelConfig: Viewer3dType\r\n  // the path is local or remote\r\n  // if texture is not defined, a default texture is applied (generateTexture)\r\n  @property({ type: Object })\r\n  modelConfig: Viewer3dType = {\r\n    object: {\r\n      path: '/models/obj/',\r\n      fileName: 'PignaOC.obj',\r\n      type: 'obj', // fbx, obj, json\r\n    },\r\n    texture: {\r\n      path: '/models/textures/',\r\n      fileName: 'PignaOC.png',\r\n    },\r\n    background: {\r\n      path: '/models/textures/',\r\n      fileName: 'studio_small_09_4k.hdr',\r\n    },\r\n  }\r\n\r\n  // React - useRef\r\n  @query('#viewer')\r\n  mount: HTMLDivElement | undefined\r\n\r\n  // React - useState\r\n  @property({ type: Object, state: true })\r\n  scene: { obj: unknown; hdrEquirect: unknown; texture: unknown } = {\r\n    obj: null,\r\n    hdrEquirect: null,\r\n    texture: null,\r\n  }\r\n\r\n  @property({ type: Boolean, state: true })\r\n  isLoaded = false\r\n\r\n  // React - componentDidMount | useEffect\r\n  override firstUpdated() {\r\n    const aUse = async () => {\r\n      const { obj, hdrEquirect, texture } = await use3DViewer(\r\n        this.mount,\r\n        this.modelConfig\r\n      )\r\n      this.scene = { obj, hdrEquirect, texture }\r\n      this.isLoaded = true\r\n    }\r\n    aUse()\r\n  }\r\n\r\n  onClickViewer(e: MouseEvent) {\r\n    e.stopPropagation()\r\n    const { obj, hdrEquirect, texture } = this.scene\r\n    this.dispatchEvent(\r\n      new CustomEvent('viewer-click', {\r\n        bubbles: true,\r\n        detail: applyTextureOnMesh(\r\n          obj as THREE.Object3D,\r\n          hdrEquirect as THREE.Texture,\r\n          texture as THREE.Texture\r\n        ),\r\n      })\r\n    )\r\n  }\r\n\r\n  override render() {\r\n    console.log('isLoaded', this.isLoaded)\r\n    return html`<div\r\n        class=${classMap({ hidden: !this.isLoaded })}\r\n        @click=${this.onClickViewer}\r\n        id=\"viewer\"\r\n      ></div>\r\n      <!-- Integrare percentuale -->\r\n      <div class=\"${classMap({ hidden: this.isLoaded })} bg-loader\">\r\n        <div class=\"${classMap({ hidden: this.isLoaded })} loader\">\r\n          loading...\r\n        </div>\r\n      </div>`\r\n  }\r\n\r\n  static override styles = css`\r\n    * {\r\n      margin: 0;\r\n      padding: 0;\r\n      box-sizing: border-box;\r\n    }\r\n    :host {\r\n      width: 100vw;\r\n      height: 100vh;\r\n      margin: 0 auto;\r\n    }\r\n    .hidden {\r\n      display: none;\r\n    }\r\n    .bg-loader {\r\n      background-color: #000;\r\n      width: 100vw;\r\n      height: 100vh;\r\n      z-index: 999;\r\n    }\r\n    .loader {\r\n      position: absolute;\r\n      top: 50%;\r\n      left: 50%;\r\n      transform: translate(-50%, -50%);\r\n      font-size: 2rem;\r\n      color: red;\r\n    }\r\n    .noselect {\r\n      -webkit-touch-callout: none; /* iOS Safari */\r\n      -webkit-user-select: none; /* Safari */\r\n      -khtml-user-select: none; /* Konqueror HTML */\r\n      -moz-user-select: none; /* Old versions of Firefox */\r\n      -ms-user-select: none; /* Internet Explorer/Edge */\r\n      user-select: none; /* Non-prefixed version, currently\r\n                            supported by Chrome, Edge, Opera and Firefox */\r\n    }\r\n\r\n    @media (prefers-color-scheme: light) {\r\n    }\r\n  `\r\n}\r\n\r\ndeclare global {\r\n  interface HTMLElementTagNameMap {\r\n    'viewer-3d-lit': Viewer3d\r\n  }\r\n}\r\n\r\n// export const Viewer3dReact = createComponent(React, 'viewer-3d-lit', Viewer3d, {\r\n//   onClickViewer: 'viewer-click',\r\n// })\r\n"]}